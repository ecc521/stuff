<script>

(async function(){
  await navigator.serviceWorker.register("/stuff/manifestcreator/sw.js")
  
  let obj = {
    name:"bob",
    short_name:"b"
  }

  let db = await new Promise(function(resolve,reject){
    let db = indexedDB.open("manifest", 1);
            
    db.onupgradeneeded = function(value) {
      console.log(value)
      let db = value.result
      console.log(db)
      db.createObjectStore('manifest', { autoIncrement: false })
      console.log(db)
      resolve(db)
    }
                
    db.onsuccess = function(){
      resolve(db.result)
    }
            
  })
            
            
 console.log(db)
 let trans = await db.transaction("manifest", "readwrite");
 console.log(trans)
 let store = await trans.objectStore("manifest")
 console.log(store)
 let manifest = await store.put(obj, "json")
 console.log(manifest) 
  
 let response = await fetch("https://ecc521.github.io/stuff/manifestcreator/manifest?")
 console.log(response)
 window.resp = response
  
  
}())

</script>
