<script src="https://ecc521.github.io/librarys/indexeddb.js"></script>

<script>

(async function(){
  
  navigator.serviceWorker.addEventListener('controllerchange', () => {
    console.log("ServiceWorker changed!")
    console.log(Date.now())
  });
  
  await navigator.serviceWorker.register("/stuff/manifestcreator/sw.js")
  console.log(Date.now())

  
  let obj = {
    name:"bob",
    short_name:"b"
  }

  let db = await lib.loaddb("manifest")
  await db.set("json", JSON.stringify(obj))
  
 let response = await fetch("https://ecc521.github.io/stuff/manifestcreator/manifest?")
 console.log(response)
 window.resp = response
  
 let txt = await resp.text()
 let manifest = await JSON.parse(txt)
 console.log(manifest)
  
}())

</script>
